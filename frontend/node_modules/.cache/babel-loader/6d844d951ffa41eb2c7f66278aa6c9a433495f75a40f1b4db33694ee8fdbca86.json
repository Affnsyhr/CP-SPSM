{"ast":null,"code":"var _jsxFileName = \"E:\\\\Integrasi CP\\\\frontend\\\\src\\\\pages\\\\student-registration.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Button } from \"../components/ui/button\";\nimport { Input } from \"../components/ui/input\";\nimport { Label } from \"../components/ui/label\";\nimport { useToast } from \"../hooks/use-toast\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function StudentRegistrationPage() {\n  _s();\n  const [student, setStudent] = useState({\n    nama_lengkap: \"\",\n    tempat_lahir: \"\",\n    tanggal_lahir: \"\",\n    jenis_kelamin: \"L\",\n    alamat: \"\"\n  });\n  const [documents, setDocuments] = useState({\n    akte: null,\n    kk: null,\n    rapor: null\n  });\n  const [programId, setProgramId] = useState(\"\");\n  const [tahunAjaranId, setTahunAjaranId] = useState(\"\");\n  const [jalur, setJalur] = useState(\"\");\n  const [catatan, setCatatan] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const {\n    toast\n  } = useToast();\n  const navigate = useNavigate();\n  const [tahunAjaranOptions, setTahunAjaranOptions] = useState([]);\n  const [sudahAdaSiswa, setSudahAdaSiswa] = useState(false);\n  const [programOptions, setProgramOptions] = useState([]);\n  const [jalurOptions, setJalurOptions] = useState([]);\n  const handleStudentChange = e => {\n    setStudent({\n      ...student,\n      [e.target.name]: e.target.value\n    });\n  };\n  const handleDocumentChange = e => {\n    setDocuments({\n      ...documents,\n      [e.target.name]: e.target.files[0]\n    });\n  };\n  const getToken = () => {\n    var _JSON$parse;\n    return localStorage.getItem('token') || ((_JSON$parse = JSON.parse(localStorage.getItem('user'))) === null || _JSON$parse === void 0 ? void 0 : _JSON$parse.token);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setIsLoading(true);\n    try {\n      // 1. Tambah siswa\n      const resSiswa = await fetch(\"/api/siswa\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${getToken()}`\n        },\n        body: JSON.stringify(student)\n      });\n      const dataSiswa = await resSiswa.json();\n      if (!resSiswa.ok || !dataSiswa.data || !dataSiswa.data.siswa_id) {\n        throw new Error(dataSiswa.message || \"Gagal menambah siswa\");\n      }\n      const siswa_id = dataSiswa.data.siswa_id;\n\n      // 2. Submit pendaftaran (dapatkan pendaftaran_id)\n      const resPendaftaran = await fetch(\"/api/pendaftaran\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${getToken()}`\n        },\n        body: JSON.stringify({\n          siswa_id,\n          program_id: programId,\n          tahun_ajaran_id: tahunAjaranId,\n          catatan\n        })\n      });\n      const dataPendaftaran = await resPendaftaran.json();\n      if (!resPendaftaran.ok || !dataPendaftaran.data || !dataPendaftaran.data.pendaftaran_id) {\n        throw new Error(dataPendaftaran.message || \"Gagal mendaftar\");\n      }\n      const pendaftaran_id = dataPendaftaran.data.pendaftaran_id;\n\n      // 3. Upload dokumen (pakai pendaftaran_id)\n      for (const [jenis, file] of Object.entries(documents)) {\n        if (!file) continue;\n        const formData = new FormData();\n        formData.append(\"file\", file);\n        formData.append(\"pendaftaran_id\", pendaftaran_id);\n        formData.append(\"jenis_dokumen\", jenis === \"kk\" ? \"kartu_keluarga\" : jenis === \"akte\" ? \"akta_kelahiran\" : \"lainnya\" // rapor dikirim sebagai 'lainnya'\n        );\n        const resDoc = await fetch(\"/api/dokumen\", {\n          method: \"POST\",\n          headers: {\n            \"Authorization\": `Bearer ${getToken()}`\n          },\n          body: formData\n        });\n        const dataDoc = await resDoc.json();\n        if (!resDoc.ok) throw new Error(dataDoc.message || `Gagal upload dokumen ${jenis}`);\n      }\n      toast({\n        title: \"Pendaftaran siswa berhasil\",\n        description: \"Data siswa dan dokumen berhasil didaftarkan.\"\n      });\n      navigate(\"/dashboard\"); // atau ke halaman lain sesuai kebutuhan\n    } catch (error) {\n      toast({\n        title: \"Pendaftaran gagal\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Fetch tahun ajaran dari backend\n  useEffect(() => {\n    fetch('/api/tahunajaran', {\n      headers: {\n        'Authorization': `Bearer ${getToken()}`\n      }\n    }).then(res => res.json()).then(data => {\n      if (data && data.data) {\n        setTahunAjaranOptions(data.data);\n      }\n    });\n  }, []);\n\n  // Cek apakah user sudah pernah mendaftarkan siswa\n  useEffect(() => {\n    fetch('/api/siswa/my', {\n      headers: {\n        'Authorization': `Bearer ${getToken()}`\n      }\n    }).then(res => res.json()).then(data => {\n      if (data && data.data && data.data.length > 0) {\n        setSudahAdaSiswa(true);\n      }\n    });\n  }, []);\n\n  // Fetch program dari backend\n  useEffect(() => {\n    fetch('/api/program', {\n      headers: {\n        'Authorization': `Bearer ${getToken()}`\n      }\n    }).then(res => res.json()).then(data => {\n      if (data && data.data) {\n        setProgramOptions(data.data);\n      }\n    });\n  }, []);\n\n  // Fetch jalur pendaftaran dari backend\n  useEffect(() => {\n    fetch('/api/program/jalur', {\n      headers: {\n        'Authorization': `Bearer ${getToken()}`\n      }\n    }).then(res => res.json()).then(data => {\n      if (data && data.data) {\n        setJalurOptions(data.data);\n      }\n    });\n  }, []);\n\n  // Ambil unique jalur dari jalurOptions\n  const uniqueJalur = Array.from(new Set(jalurOptions.map(j => j.jenis_pendaftar))).map(jenis => {\n    return jalurOptions.find(j => j.jenis_pendaftar === jenis);\n  });\n\n  // Mapping label jalur\n  const getJalurLabel = value => {\n    switch (value) {\n      case 'reguler':\n        return 'Reguler';\n      case 'Prestasi akademik':\n        return 'Prestasi Akademik';\n      case 'prestasi non akademik':\n        return 'Prestasi Non Akademik';\n      case 'tahfiz':\n        return 'Tahfizh';\n      default:\n        return value;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex min-h-screen items-center justify-center p-6\",\n    children: sudahAdaSiswa ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-lg bg-white p-8 rounded-lg shadow text-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl font-bold mb-4\",\n        children: \"Pendaftaran Siswa\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mb-4\",\n        children: \"Anda sudah mendaftarkan siswa. Satu wali hanya boleh mendaftarkan satu siswa.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: () => navigate('/dashboard'),\n        children: \"Kembali ke Dashboard\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"w-full max-w-lg space-y-6 bg-white p-8 rounded-lg shadow\",\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl font-bold mb-4\",\n        children: \"Pendaftaran Siswa Baru\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"nama_lengkap\",\n          children: \"Nama Lengkap Siswa\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"nama_lengkap\",\n          name: \"nama_lengkap\",\n          value: student.nama_lengkap,\n          onChange: handleStudentChange,\n          required: true,\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"tempat_lahir\",\n          children: \"Tempat Lahir\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"tempat_lahir\",\n          name: \"tempat_lahir\",\n          value: student.tempat_lahir,\n          onChange: handleStudentChange,\n          required: true,\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"tanggal_lahir\",\n          children: \"Tanggal Lahir\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"tanggal_lahir\",\n          name: \"tanggal_lahir\",\n          type: \"date\",\n          value: student.tanggal_lahir,\n          onChange: handleStudentChange,\n          required: true,\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"jenis_kelamin\",\n          children: \"Jenis Kelamin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          id: \"jenis_kelamin\",\n          name: \"jenis_kelamin\",\n          value: student.jenis_kelamin,\n          onChange: handleStudentChange,\n          required: true,\n          disabled: isLoading,\n          className: \"w-full border rounded p-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"L\",\n            children: \"Laki-laki\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"P\",\n            children: \"Perempuan\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"alamat\",\n          children: \"Alamat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"alamat\",\n          name: \"alamat\",\n          value: student.alamat,\n          onChange: handleStudentChange,\n          required: true,\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"akte\",\n          children: \"Akte Kelahiran (PDF)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"akte\",\n          name: \"akte\",\n          type: \"file\",\n          accept: \".pdf\",\n          onChange: handleDocumentChange,\n          required: true,\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"kk\",\n          children: \"Kartu Keluarga (PDF)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"kk\",\n          name: \"kk\",\n          type: \"file\",\n          accept: \".pdf\",\n          onChange: handleDocumentChange,\n          required: true,\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"rapor\",\n          children: \"Rapor (PDF)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"rapor\",\n          name: \"rapor\",\n          type: \"file\",\n          accept: \".pdf\",\n          onChange: handleDocumentChange,\n          required: true,\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"program\",\n          children: \"Program Sekolah\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          id: \"program\",\n          value: programId,\n          onChange: e => setProgramId(e.target.value),\n          required: true,\n          disabled: isLoading,\n          className: \"w-full border rounded p-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Pilih Program\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 15\n          }, this), programOptions.map(opt => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: opt.program_id,\n            children: opt.nama_program\n          }, opt.program_id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"jalur\",\n          children: \"Jalur Pendaftaran\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          id: \"jalur\",\n          name: \"jalur\",\n          value: jalur,\n          onChange: e => setJalur(e.target.value),\n          required: true,\n          className: \"w-full border rounded px-3 py-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Pilih Jalur\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 15\n          }, this), uniqueJalur.map(jalur => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: jalur.jenis_pendaftar,\n            children: jalur.jenis_pendaftar\n          }, jalur.jenis_pendaftar, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"tahunajaran\",\n          children: \"Tahun Ajaran\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          id: \"tahunajaran\",\n          value: tahunAjaranId,\n          onChange: e => setTahunAjaranId(e.target.value),\n          required: true,\n          disabled: isLoading,\n          className: \"w-full border rounded p-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Pilih Tahun Ajaran\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 15\n          }, this), tahunAjaranOptions.map(opt => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: opt.id_tahunajaran,\n            children: opt.tahun_ajaran\n          }, opt.id_tahunajaran, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(Label, {\n          htmlFor: \"catatan\",\n          children: \"Catatan (opsional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          id: \"catatan\",\n          value: catatan,\n          onChange: e => setCatatan(e.target.value),\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        type: \"submit\",\n        className: \"w-full\",\n        disabled: isLoading,\n        children: isLoading ? \"Memproses...\" : \"Daftarkan Siswa\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        type: \"button\",\n        variant: \"outline\",\n        className: \"w-full\",\n        onClick: () => navigate('/dashboard'),\n        disabled: isLoading,\n        children: \"Kembali\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 203,\n    columnNumber: 5\n  }, this);\n}\n_s(StudentRegistrationPage, \"vB48yZOOVs4ge+6V1CHVbDNKwdw=\", false, function () {\n  return [useToast, useNavigate];\n});\n_c = StudentRegistrationPage;\nvar _c;\n$RefreshReg$(_c, \"StudentRegistrationPage\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Button","Input","Label","useToast","jsxDEV","_jsxDEV","StudentRegistrationPage","_s","student","setStudent","nama_lengkap","tempat_lahir","tanggal_lahir","jenis_kelamin","alamat","documents","setDocuments","akte","kk","rapor","programId","setProgramId","tahunAjaranId","setTahunAjaranId","jalur","setJalur","catatan","setCatatan","isLoading","setIsLoading","toast","navigate","tahunAjaranOptions","setTahunAjaranOptions","sudahAdaSiswa","setSudahAdaSiswa","programOptions","setProgramOptions","jalurOptions","setJalurOptions","handleStudentChange","e","target","name","value","handleDocumentChange","files","getToken","_JSON$parse","localStorage","getItem","JSON","parse","token","handleSubmit","preventDefault","resSiswa","fetch","method","headers","body","stringify","dataSiswa","json","ok","data","siswa_id","Error","message","resPendaftaran","program_id","tahun_ajaran_id","dataPendaftaran","pendaftaran_id","jenis","file","Object","entries","formData","FormData","append","resDoc","dataDoc","title","description","error","variant","then","res","length","uniqueJalur","Array","from","Set","map","j","jenis_pendaftar","find","getJalurLabel","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onSubmit","htmlFor","id","onChange","required","disabled","type","accept","opt","nama_program","id_tahunajaran","tahun_ajaran","_c","$RefreshReg$"],"sources":["E:/Integrasi CP/frontend/src/pages/student-registration.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { Button } from \"../components/ui/button\";\r\nimport { Input } from \"../components/ui/input\";\r\nimport { Label } from \"../components/ui/label\";\r\nimport { useToast } from \"../hooks/use-toast\";\r\n\r\nexport default function StudentRegistrationPage() {\r\n  const [student, setStudent] = useState({\r\n    nama_lengkap: \"\",\r\n    tempat_lahir: \"\",\r\n    tanggal_lahir: \"\",\r\n    jenis_kelamin: \"L\",\r\n    alamat: \"\"\r\n  });\r\n  const [documents, setDocuments] = useState({\r\n    akte: null,\r\n    kk: null,\r\n    rapor: null,\r\n  });\r\n  const [programId, setProgramId] = useState(\"\");\r\n  const [tahunAjaranId, setTahunAjaranId] = useState(\"\");\r\n  const [jalur, setJalur] = useState(\"\");\r\n  const [catatan, setCatatan] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { toast } = useToast();\r\n  const navigate = useNavigate();\r\n  const [tahunAjaranOptions, setTahunAjaranOptions] = useState([]);\r\n  const [sudahAdaSiswa, setSudahAdaSiswa] = useState(false);\r\n  const [programOptions, setProgramOptions] = useState([]);\r\n  const [jalurOptions, setJalurOptions] = useState([]);\r\n\r\n  const handleStudentChange = (e) => {\r\n    setStudent({ ...student, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleDocumentChange = (e) => {\r\n    setDocuments({ ...documents, [e.target.name]: e.target.files[0] });\r\n  };\r\n\r\n  const getToken = () => {\r\n    return localStorage.getItem('token') || (JSON.parse(localStorage.getItem('user'))?.token);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    try {\r\n      // 1. Tambah siswa\r\n      const resSiswa = await fetch(\"/api/siswa\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"Authorization\": `Bearer ${getToken()}`\r\n        },\r\n        body: JSON.stringify(student),\r\n      });\r\n      const dataSiswa = await resSiswa.json();\r\n      if (!resSiswa.ok || !dataSiswa.data || !dataSiswa.data.siswa_id) {\r\n        throw new Error(dataSiswa.message || \"Gagal menambah siswa\");\r\n      }\r\n      const siswa_id = dataSiswa.data.siswa_id;\r\n\r\n      // 2. Submit pendaftaran (dapatkan pendaftaran_id)\r\n      const resPendaftaran = await fetch(\"/api/pendaftaran\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"Authorization\": `Bearer ${getToken()}`\r\n        },\r\n        body: JSON.stringify({\r\n          siswa_id,\r\n          program_id: programId,\r\n          tahun_ajaran_id: tahunAjaranId,\r\n          catatan,\r\n        }),\r\n      });\r\n      const dataPendaftaran = await resPendaftaran.json();\r\n      if (!resPendaftaran.ok || !dataPendaftaran.data || !dataPendaftaran.data.pendaftaran_id) {\r\n        throw new Error(dataPendaftaran.message || \"Gagal mendaftar\");\r\n      }\r\n      const pendaftaran_id = dataPendaftaran.data.pendaftaran_id;\r\n\r\n      // 3. Upload dokumen (pakai pendaftaran_id)\r\n      for (const [jenis, file] of Object.entries(documents)) {\r\n        if (!file) continue;\r\n        const formData = new FormData();\r\n        formData.append(\"file\", file);\r\n        formData.append(\"pendaftaran_id\", pendaftaran_id);\r\n        formData.append(\"jenis_dokumen\",\r\n          jenis === \"kk\"\r\n            ? \"kartu_keluarga\"\r\n            : jenis === \"akte\"\r\n            ? \"akta_kelahiran\"\r\n            : \"lainnya\" // rapor dikirim sebagai 'lainnya'\r\n        );\r\n        const resDoc = await fetch(\"/api/dokumen\", {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Authorization\": `Bearer ${getToken()}`\r\n          },\r\n          body: formData,\r\n        });\r\n        const dataDoc = await resDoc.json();\r\n        if (!resDoc.ok) throw new Error(dataDoc.message || `Gagal upload dokumen ${jenis}`);\r\n      }\r\n\r\n      toast({\r\n        title: \"Pendaftaran siswa berhasil\",\r\n        description: \"Data siswa dan dokumen berhasil didaftarkan.\",\r\n      });\r\n      navigate(\"/dashboard\"); // atau ke halaman lain sesuai kebutuhan\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Pendaftaran gagal\",\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Fetch tahun ajaran dari backend\r\n  useEffect(() => {\r\n    fetch('/api/tahunajaran', {\r\n      headers: {\r\n        'Authorization': `Bearer ${getToken()}`\r\n      }\r\n    })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (data && data.data) {\r\n          setTahunAjaranOptions(data.data);\r\n        }\r\n      });\r\n  }, []);\r\n\r\n  // Cek apakah user sudah pernah mendaftarkan siswa\r\n  useEffect(() => {\r\n    fetch('/api/siswa/my', {\r\n      headers: {\r\n        'Authorization': `Bearer ${getToken()}`\r\n      }\r\n    })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (data && data.data && data.data.length > 0) {\r\n          setSudahAdaSiswa(true);\r\n        }\r\n      });\r\n  }, []);\r\n\r\n  // Fetch program dari backend\r\n  useEffect(() => {\r\n    fetch('/api/program', {\r\n      headers: {\r\n        'Authorization': `Bearer ${getToken()}`\r\n      }\r\n    })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (data && data.data) {\r\n          setProgramOptions(data.data);\r\n        }\r\n      });\r\n  }, []);\r\n\r\n  // Fetch jalur pendaftaran dari backend\r\n  useEffect(() => {\r\n    fetch('/api/program/jalur', {\r\n      headers: {\r\n        'Authorization': `Bearer ${getToken()}`\r\n      }\r\n    })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (data && data.data) {\r\n          setJalurOptions(data.data);\r\n        }\r\n      });\r\n  }, []);\r\n\r\n  // Ambil unique jalur dari jalurOptions\r\n  const uniqueJalur = Array.from(\r\n    new Set(jalurOptions.map(j => j.jenis_pendaftar))\r\n  ).map(jenis => {\r\n    return jalurOptions.find(j => j.jenis_pendaftar === jenis);\r\n  });\r\n\r\n  // Mapping label jalur\r\n  const getJalurLabel = (value) => {\r\n    switch (value) {\r\n      case 'reguler': return 'Reguler';\r\n      case 'Prestasi akademik': return 'Prestasi Akademik';\r\n      case 'prestasi non akademik': return 'Prestasi Non Akademik';\r\n      case 'tahfiz': return 'Tahfizh';\r\n      default: return value;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen items-center justify-center p-6\">\r\n      {sudahAdaSiswa ? (\r\n        <div className=\"w-full max-w-lg bg-white p-8 rounded-lg shadow text-center\">\r\n          <h1 className=\"text-2xl font-bold mb-4\">Pendaftaran Siswa</h1>\r\n          <p className=\"mb-4\">Anda sudah mendaftarkan siswa. Satu wali hanya boleh mendaftarkan satu siswa.</p>\r\n          <Button onClick={() => navigate('/dashboard')}>Kembali ke Dashboard</Button>\r\n        </div>\r\n      ) : (\r\n        <form className=\"w-full max-w-lg space-y-6 bg-white p-8 rounded-lg shadow\" onSubmit={handleSubmit}>\r\n          <h1 className=\"text-2xl font-bold mb-4\">Pendaftaran Siswa Baru</h1>\r\n          {/* Data Siswa */}\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"nama_lengkap\">Nama Lengkap Siswa</Label>\r\n            <Input id=\"nama_lengkap\" name=\"nama_lengkap\" value={student.nama_lengkap} onChange={handleStudentChange} required disabled={isLoading} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"tempat_lahir\">Tempat Lahir</Label>\r\n            <Input id=\"tempat_lahir\" name=\"tempat_lahir\" value={student.tempat_lahir} onChange={handleStudentChange} required disabled={isLoading} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"tanggal_lahir\">Tanggal Lahir</Label>\r\n            <Input id=\"tanggal_lahir\" name=\"tanggal_lahir\" type=\"date\" value={student.tanggal_lahir} onChange={handleStudentChange} required disabled={isLoading} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"jenis_kelamin\">Jenis Kelamin</Label>\r\n            <select id=\"jenis_kelamin\" name=\"jenis_kelamin\" value={student.jenis_kelamin} onChange={handleStudentChange} required disabled={isLoading} className=\"w-full border rounded p-2\">\r\n              <option value=\"L\">Laki-laki</option>\r\n              <option value=\"P\">Perempuan</option>\r\n            </select>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"alamat\">Alamat</Label>\r\n            <Input id=\"alamat\" name=\"alamat\" value={student.alamat} onChange={handleStudentChange} required disabled={isLoading} />\r\n          </div>\r\n          {/* Upload Dokumen */}\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"akte\">Akte Kelahiran (PDF)</Label>\r\n            <Input id=\"akte\" name=\"akte\" type=\"file\" accept=\".pdf\" onChange={handleDocumentChange} required disabled={isLoading} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"kk\">Kartu Keluarga (PDF)</Label>\r\n            <Input id=\"kk\" name=\"kk\" type=\"file\" accept=\".pdf\" onChange={handleDocumentChange} required disabled={isLoading} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"rapor\">Rapor (PDF)</Label>\r\n            <Input id=\"rapor\" name=\"rapor\" type=\"file\" accept=\".pdf\" onChange={handleDocumentChange} required disabled={isLoading} />\r\n          </div>\r\n          {/* Pilihan Program, Jalur, Tahun Ajaran */}\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"program\">Program Sekolah</Label>\r\n            <select id=\"program\" value={programId} onChange={e => setProgramId(e.target.value)} required disabled={isLoading} className=\"w-full border rounded p-2\">\r\n              <option value=\"\">Pilih Program</option>\r\n              {programOptions.map(opt => (\r\n                <option key={opt.program_id} value={opt.program_id}>{opt.nama_program}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"jalur\">Jalur Pendaftaran</Label>\r\n            <select\r\n              id=\"jalur\"\r\n              name=\"jalur\"\r\n              value={jalur}\r\n              onChange={e => setJalur(e.target.value)}\r\n              required\r\n              className=\"w-full border rounded px-3 py-2\"\r\n            >\r\n              <option value=\"\">Pilih Jalur</option>\r\n              {uniqueJalur.map(jalur => (\r\n                <option key={jalur.jenis_pendaftar} value={jalur.jenis_pendaftar}>\r\n                  {jalur.jenis_pendaftar}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"tahunajaran\">Tahun Ajaran</Label>\r\n            <select id=\"tahunajaran\" value={tahunAjaranId} onChange={e => setTahunAjaranId(e.target.value)} required disabled={isLoading} className=\"w-full border rounded p-2\">\r\n              <option value=\"\">Pilih Tahun Ajaran</option>\r\n              {tahunAjaranOptions.map(opt => (\r\n                <option key={opt.id_tahunajaran} value={opt.id_tahunajaran}>{opt.tahun_ajaran}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"catatan\">Catatan (opsional)</Label>\r\n            <Input id=\"catatan\" value={catatan} onChange={e => setCatatan(e.target.value)} disabled={isLoading} />\r\n          </div>\r\n          <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n            {isLoading ? \"Memproses...\" : \"Daftarkan Siswa\"}\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            className=\"w-full\"\r\n            onClick={() => navigate('/dashboard')}\r\n            disabled={isLoading}\r\n          >\r\n            Kembali\r\n          </Button>\r\n        </form>\r\n      )}\r\n    </div>\r\n  );\r\n} "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,MAAM,QAAQ,yBAAyB;AAChD,SAASC,KAAK,QAAQ,wBAAwB;AAC9C,SAASC,KAAK,QAAQ,wBAAwB;AAC9C,SAASC,QAAQ,QAAQ,oBAAoB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE9C,eAAe,SAASC,uBAAuBA,CAAA,EAAG;EAAAC,EAAA;EAChD,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC;IACrCa,YAAY,EAAE,EAAE;IAChBC,YAAY,EAAE,EAAE;IAChBC,aAAa,EAAE,EAAE;IACjBC,aAAa,EAAE,GAAG;IAClBC,MAAM,EAAE;EACV,CAAC,CAAC;EACF,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGnB,QAAQ,CAAC;IACzCoB,IAAI,EAAE,IAAI;IACVC,EAAE,EAAE,IAAI;IACRC,KAAK,EAAE;EACT,CAAC,CAAC;EACF,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGxB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACyB,aAAa,EAAEC,gBAAgB,CAAC,GAAG1B,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAAC2B,KAAK,EAAEC,QAAQ,CAAC,GAAG5B,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAAC6B,OAAO,EAAEC,UAAU,CAAC,GAAG9B,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAAC+B,SAAS,EAAEC,YAAY,CAAC,GAAGhC,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM;IAAEiC;EAAM,CAAC,GAAG3B,QAAQ,CAAC,CAAC;EAC5B,MAAM4B,QAAQ,GAAGhC,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACiC,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGpC,QAAQ,CAAC,EAAE,CAAC;EAChE,MAAM,CAACqC,aAAa,EAAEC,gBAAgB,CAAC,GAAGtC,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAACuC,cAAc,EAAEC,iBAAiB,CAAC,GAAGxC,QAAQ,CAAC,EAAE,CAAC;EACxD,MAAM,CAACyC,YAAY,EAAEC,eAAe,CAAC,GAAG1C,QAAQ,CAAC,EAAE,CAAC;EAEpD,MAAM2C,mBAAmB,GAAIC,CAAC,IAAK;IACjChC,UAAU,CAAC;MAAE,GAAGD,OAAO;MAAE,CAACiC,CAAC,CAACC,MAAM,CAACC,IAAI,GAAGF,CAAC,CAACC,MAAM,CAACE;IAAM,CAAC,CAAC;EAC7D,CAAC;EAED,MAAMC,oBAAoB,GAAIJ,CAAC,IAAK;IAClCzB,YAAY,CAAC;MAAE,GAAGD,SAAS;MAAE,CAAC0B,CAAC,CAACC,MAAM,CAACC,IAAI,GAAGF,CAAC,CAACC,MAAM,CAACI,KAAK,CAAC,CAAC;IAAE,CAAC,CAAC;EACpE,CAAC;EAED,MAAMC,QAAQ,GAAGA,CAAA,KAAM;IAAA,IAAAC,WAAA;IACrB,OAAOC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,MAAAF,WAAA,GAAKG,IAAI,CAACC,KAAK,CAACH,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,cAAAF,WAAA,uBAAxCA,WAAA,CAA0CK,KAAK,CAAC;EAC3F,CAAC;EAED,MAAMC,YAAY,GAAG,MAAOb,CAAC,IAAK;IAChCA,CAAC,CAACc,cAAc,CAAC,CAAC;IAClB1B,YAAY,CAAC,IAAI,CAAC;IAClB,IAAI;MACF;MACA,MAAM2B,QAAQ,GAAG,MAAMC,KAAK,CAAC,YAAY,EAAE;QACzCC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClC,eAAe,EAAE,UAAUZ,QAAQ,CAAC,CAAC;QACvC,CAAC;QACDa,IAAI,EAAET,IAAI,CAACU,SAAS,CAACrD,OAAO;MAC9B,CAAC,CAAC;MACF,MAAMsD,SAAS,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;MACvC,IAAI,CAACP,QAAQ,CAACQ,EAAE,IAAI,CAACF,SAAS,CAACG,IAAI,IAAI,CAACH,SAAS,CAACG,IAAI,CAACC,QAAQ,EAAE;QAC/D,MAAM,IAAIC,KAAK,CAACL,SAAS,CAACM,OAAO,IAAI,sBAAsB,CAAC;MAC9D;MACA,MAAMF,QAAQ,GAAGJ,SAAS,CAACG,IAAI,CAACC,QAAQ;;MAExC;MACA,MAAMG,cAAc,GAAG,MAAMZ,KAAK,CAAC,kBAAkB,EAAE;QACrDC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClC,eAAe,EAAE,UAAUZ,QAAQ,CAAC,CAAC;QACvC,CAAC;QACDa,IAAI,EAAET,IAAI,CAACU,SAAS,CAAC;UACnBK,QAAQ;UACRI,UAAU,EAAElD,SAAS;UACrBmD,eAAe,EAAEjD,aAAa;UAC9BI;QACF,CAAC;MACH,CAAC,CAAC;MACF,MAAM8C,eAAe,GAAG,MAAMH,cAAc,CAACN,IAAI,CAAC,CAAC;MACnD,IAAI,CAACM,cAAc,CAACL,EAAE,IAAI,CAACQ,eAAe,CAACP,IAAI,IAAI,CAACO,eAAe,CAACP,IAAI,CAACQ,cAAc,EAAE;QACvF,MAAM,IAAIN,KAAK,CAACK,eAAe,CAACJ,OAAO,IAAI,iBAAiB,CAAC;MAC/D;MACA,MAAMK,cAAc,GAAGD,eAAe,CAACP,IAAI,CAACQ,cAAc;;MAE1D;MACA,KAAK,MAAM,CAACC,KAAK,EAAEC,IAAI,CAAC,IAAIC,MAAM,CAACC,OAAO,CAAC9D,SAAS,CAAC,EAAE;QACrD,IAAI,CAAC4D,IAAI,EAAE;QACX,MAAMG,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;QAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEL,IAAI,CAAC;QAC7BG,QAAQ,CAACE,MAAM,CAAC,gBAAgB,EAAEP,cAAc,CAAC;QACjDK,QAAQ,CAACE,MAAM,CAAC,eAAe,EAC7BN,KAAK,KAAK,IAAI,GACV,gBAAgB,GAChBA,KAAK,KAAK,MAAM,GAChB,gBAAgB,GAChB,SAAS,CAAC;QAChB,CAAC;QACD,MAAMO,MAAM,GAAG,MAAMxB,KAAK,CAAC,cAAc,EAAE;UACzCC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACP,eAAe,EAAE,UAAUZ,QAAQ,CAAC,CAAC;UACvC,CAAC;UACDa,IAAI,EAAEkB;QACR,CAAC,CAAC;QACF,MAAMI,OAAO,GAAG,MAAMD,MAAM,CAAClB,IAAI,CAAC,CAAC;QACnC,IAAI,CAACkB,MAAM,CAACjB,EAAE,EAAE,MAAM,IAAIG,KAAK,CAACe,OAAO,CAACd,OAAO,IAAI,wBAAwBM,KAAK,EAAE,CAAC;MACrF;MAEA5C,KAAK,CAAC;QACJqD,KAAK,EAAE,4BAA4B;QACnCC,WAAW,EAAE;MACf,CAAC,CAAC;MACFrD,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;IAC1B,CAAC,CAAC,OAAOsD,KAAK,EAAE;MACdvD,KAAK,CAAC;QACJqD,KAAK,EAAE,mBAAmB;QAC1BC,WAAW,EAAEC,KAAK,CAACjB,OAAO;QAC1BkB,OAAO,EAAE;MACX,CAAC,CAAC;IACJ,CAAC,SAAS;MACRzD,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;;EAED;EACA/B,SAAS,CAAC,MAAM;IACd2D,KAAK,CAAC,kBAAkB,EAAE;MACxBE,OAAO,EAAE;QACP,eAAe,EAAE,UAAUZ,QAAQ,CAAC,CAAC;MACvC;IACF,CAAC,CAAC,CACCwC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACzB,IAAI,CAAC,CAAC,CAAC,CACvBwB,IAAI,CAACtB,IAAI,IAAI;MACZ,IAAIA,IAAI,IAAIA,IAAI,CAACA,IAAI,EAAE;QACrBhC,qBAAqB,CAACgC,IAAI,CAACA,IAAI,CAAC;MAClC;IACF,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAnE,SAAS,CAAC,MAAM;IACd2D,KAAK,CAAC,eAAe,EAAE;MACrBE,OAAO,EAAE;QACP,eAAe,EAAE,UAAUZ,QAAQ,CAAC,CAAC;MACvC;IACF,CAAC,CAAC,CACCwC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACzB,IAAI,CAAC,CAAC,CAAC,CACvBwB,IAAI,CAACtB,IAAI,IAAI;MACZ,IAAIA,IAAI,IAAIA,IAAI,CAACA,IAAI,IAAIA,IAAI,CAACA,IAAI,CAACwB,MAAM,GAAG,CAAC,EAAE;QAC7CtD,gBAAgB,CAAC,IAAI,CAAC;MACxB;IACF,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;;EAEN;EACArC,SAAS,CAAC,MAAM;IACd2D,KAAK,CAAC,cAAc,EAAE;MACpBE,OAAO,EAAE;QACP,eAAe,EAAE,UAAUZ,QAAQ,CAAC,CAAC;MACvC;IACF,CAAC,CAAC,CACCwC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACzB,IAAI,CAAC,CAAC,CAAC,CACvBwB,IAAI,CAACtB,IAAI,IAAI;MACZ,IAAIA,IAAI,IAAIA,IAAI,CAACA,IAAI,EAAE;QACrB5B,iBAAiB,CAAC4B,IAAI,CAACA,IAAI,CAAC;MAC9B;IACF,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAnE,SAAS,CAAC,MAAM;IACd2D,KAAK,CAAC,oBAAoB,EAAE;MAC1BE,OAAO,EAAE;QACP,eAAe,EAAE,UAAUZ,QAAQ,CAAC,CAAC;MACvC;IACF,CAAC,CAAC,CACCwC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACzB,IAAI,CAAC,CAAC,CAAC,CACvBwB,IAAI,CAACtB,IAAI,IAAI;MACZ,IAAIA,IAAI,IAAIA,IAAI,CAACA,IAAI,EAAE;QACrB1B,eAAe,CAAC0B,IAAI,CAACA,IAAI,CAAC;MAC5B;IACF,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMyB,WAAW,GAAGC,KAAK,CAACC,IAAI,CAC5B,IAAIC,GAAG,CAACvD,YAAY,CAACwD,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,eAAe,CAAC,CAClD,CAAC,CAACF,GAAG,CAACpB,KAAK,IAAI;IACb,OAAOpC,YAAY,CAAC2D,IAAI,CAACF,CAAC,IAAIA,CAAC,CAACC,eAAe,KAAKtB,KAAK,CAAC;EAC5D,CAAC,CAAC;;EAEF;EACA,MAAMwB,aAAa,GAAItD,KAAK,IAAK;IAC/B,QAAQA,KAAK;MACX,KAAK,SAAS;QAAE,OAAO,SAAS;MAChC,KAAK,mBAAmB;QAAE,OAAO,mBAAmB;MACpD,KAAK,uBAAuB;QAAE,OAAO,uBAAuB;MAC5D,KAAK,QAAQ;QAAE,OAAO,SAAS;MAC/B;QAAS,OAAOA,KAAK;IACvB;EACF,CAAC;EAED,oBACEvC,OAAA;IAAK8F,SAAS,EAAC,mDAAmD;IAAAC,QAAA,EAC/DlE,aAAa,gBACZ7B,OAAA;MAAK8F,SAAS,EAAC,4DAA4D;MAAAC,QAAA,gBACzE/F,OAAA;QAAI8F,SAAS,EAAC,yBAAyB;QAAAC,QAAA,EAAC;MAAiB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC9DnG,OAAA;QAAG8F,SAAS,EAAC,MAAM;QAAAC,QAAA,EAAC;MAA6E;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eACrGnG,OAAA,CAACL,MAAM;QAACyG,OAAO,EAAEA,CAAA,KAAM1E,QAAQ,CAAC,YAAY,CAAE;QAAAqE,QAAA,EAAC;MAAoB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACzE,CAAC,gBAENnG,OAAA;MAAM8F,SAAS,EAAC,0DAA0D;MAACO,QAAQ,EAAEpD,YAAa;MAAA8C,QAAA,gBAChG/F,OAAA;QAAI8F,SAAS,EAAC,yBAAyB;QAAAC,QAAA,EAAC;MAAsB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAEnEnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,cAAc;UAAAP,QAAA,EAAC;QAAkB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACxDnG,OAAA,CAACJ,KAAK;UAAC2G,EAAE,EAAC,cAAc;UAACjE,IAAI,EAAC,cAAc;UAACC,KAAK,EAAEpC,OAAO,CAACE,YAAa;UAACmG,QAAQ,EAAErE,mBAAoB;UAACsE,QAAQ;UAACC,QAAQ,EAAEnF;QAAU;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtI,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,cAAc;UAAAP,QAAA,EAAC;QAAY;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAClDnG,OAAA,CAACJ,KAAK;UAAC2G,EAAE,EAAC,cAAc;UAACjE,IAAI,EAAC,cAAc;UAACC,KAAK,EAAEpC,OAAO,CAACG,YAAa;UAACkG,QAAQ,EAAErE,mBAAoB;UAACsE,QAAQ;UAACC,QAAQ,EAAEnF;QAAU;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtI,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,eAAe;UAAAP,QAAA,EAAC;QAAa;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACpDnG,OAAA,CAACJ,KAAK;UAAC2G,EAAE,EAAC,eAAe;UAACjE,IAAI,EAAC,eAAe;UAACqE,IAAI,EAAC,MAAM;UAACpE,KAAK,EAAEpC,OAAO,CAACI,aAAc;UAACiG,QAAQ,EAAErE,mBAAoB;UAACsE,QAAQ;UAACC,QAAQ,EAAEnF;QAAU;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrJ,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,eAAe;UAAAP,QAAA,EAAC;QAAa;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACpDnG,OAAA;UAAQuG,EAAE,EAAC,eAAe;UAACjE,IAAI,EAAC,eAAe;UAACC,KAAK,EAAEpC,OAAO,CAACK,aAAc;UAACgG,QAAQ,EAAErE,mBAAoB;UAACsE,QAAQ;UAACC,QAAQ,EAAEnF,SAAU;UAACuE,SAAS,EAAC,2BAA2B;UAAAC,QAAA,gBAC9K/F,OAAA;YAAQuC,KAAK,EAAC,GAAG;YAAAwD,QAAA,EAAC;UAAS;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACpCnG,OAAA;YAAQuC,KAAK,EAAC,GAAG;YAAAwD,QAAA,EAAC;UAAS;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9B,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,QAAQ;UAAAP,QAAA,EAAC;QAAM;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACtCnG,OAAA,CAACJ,KAAK;UAAC2G,EAAE,EAAC,QAAQ;UAACjE,IAAI,EAAC,QAAQ;UAACC,KAAK,EAAEpC,OAAO,CAACM,MAAO;UAAC+F,QAAQ,EAAErE,mBAAoB;UAACsE,QAAQ;UAACC,QAAQ,EAAEnF;QAAU;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpH,CAAC,eAENnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,MAAM;UAAAP,QAAA,EAAC;QAAoB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAClDnG,OAAA,CAACJ,KAAK;UAAC2G,EAAE,EAAC,MAAM;UAACjE,IAAI,EAAC,MAAM;UAACqE,IAAI,EAAC,MAAM;UAACC,MAAM,EAAC,MAAM;UAACJ,QAAQ,EAAEhE,oBAAqB;UAACiE,QAAQ;UAACC,QAAQ,EAAEnF;QAAU;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpH,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,IAAI;UAAAP,QAAA,EAAC;QAAoB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAChDnG,OAAA,CAACJ,KAAK;UAAC2G,EAAE,EAAC,IAAI;UAACjE,IAAI,EAAC,IAAI;UAACqE,IAAI,EAAC,MAAM;UAACC,MAAM,EAAC,MAAM;UAACJ,QAAQ,EAAEhE,oBAAqB;UAACiE,QAAQ;UAACC,QAAQ,EAAEnF;QAAU;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAChH,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,OAAO;UAAAP,QAAA,EAAC;QAAW;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAC1CnG,OAAA,CAACJ,KAAK;UAAC2G,EAAE,EAAC,OAAO;UAACjE,IAAI,EAAC,OAAO;UAACqE,IAAI,EAAC,MAAM;UAACC,MAAM,EAAC,MAAM;UAACJ,QAAQ,EAAEhE,oBAAqB;UAACiE,QAAQ;UAACC,QAAQ,EAAEnF;QAAU;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtH,CAAC,eAENnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,SAAS;UAAAP,QAAA,EAAC;QAAe;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAChDnG,OAAA;UAAQuG,EAAE,EAAC,SAAS;UAAChE,KAAK,EAAExB,SAAU;UAACyF,QAAQ,EAAEpE,CAAC,IAAIpB,YAAY,CAACoB,CAAC,CAACC,MAAM,CAACE,KAAK,CAAE;UAACkE,QAAQ;UAACC,QAAQ,EAAEnF,SAAU;UAACuE,SAAS,EAAC,2BAA2B;UAAAC,QAAA,gBACrJ/F,OAAA;YAAQuC,KAAK,EAAC,EAAE;YAAAwD,QAAA,EAAC;UAAa;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,EACtCpE,cAAc,CAAC0D,GAAG,CAACoB,GAAG,iBACrB7G,OAAA;YAA6BuC,KAAK,EAAEsE,GAAG,CAAC5C,UAAW;YAAA8B,QAAA,EAAEc,GAAG,CAACC;UAAY,GAAxDD,GAAG,CAAC5C,UAAU;YAAA+B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAmD,CAC/E,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,OAAO;UAAAP,QAAA,EAAC;QAAiB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAChDnG,OAAA;UACEuG,EAAE,EAAC,OAAO;UACVjE,IAAI,EAAC,OAAO;UACZC,KAAK,EAAEpB,KAAM;UACbqF,QAAQ,EAAEpE,CAAC,IAAIhB,QAAQ,CAACgB,CAAC,CAACC,MAAM,CAACE,KAAK,CAAE;UACxCkE,QAAQ;UACRX,SAAS,EAAC,iCAAiC;UAAAC,QAAA,gBAE3C/F,OAAA;YAAQuC,KAAK,EAAC,EAAE;YAAAwD,QAAA,EAAC;UAAW;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,EACpCd,WAAW,CAACI,GAAG,CAACtE,KAAK,iBACpBnB,OAAA;YAAoCuC,KAAK,EAAEpB,KAAK,CAACwE,eAAgB;YAAAI,QAAA,EAC9D5E,KAAK,CAACwE;UAAe,GADXxE,KAAK,CAACwE,eAAe;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAE1B,CACT,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,aAAa;UAAAP,QAAA,EAAC;QAAY;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACjDnG,OAAA;UAAQuG,EAAE,EAAC,aAAa;UAAChE,KAAK,EAAEtB,aAAc;UAACuF,QAAQ,EAAEpE,CAAC,IAAIlB,gBAAgB,CAACkB,CAAC,CAACC,MAAM,CAACE,KAAK,CAAE;UAACkE,QAAQ;UAACC,QAAQ,EAAEnF,SAAU;UAACuE,SAAS,EAAC,2BAA2B;UAAAC,QAAA,gBACjK/F,OAAA;YAAQuC,KAAK,EAAC,EAAE;YAAAwD,QAAA,EAAC;UAAkB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,EAC3CxE,kBAAkB,CAAC8D,GAAG,CAACoB,GAAG,iBACzB7G,OAAA;YAAiCuC,KAAK,EAAEsE,GAAG,CAACE,cAAe;YAAAhB,QAAA,EAAEc,GAAG,CAACG;UAAY,GAAhEH,GAAG,CAACE,cAAc;YAAAf,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAuD,CACvF,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eACNnG,OAAA;QAAK8F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACxB/F,OAAA,CAACH,KAAK;UAACyG,OAAO,EAAC,SAAS;UAAAP,QAAA,EAAC;QAAkB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACnDnG,OAAA,CAACJ,KAAK;UAAC2G,EAAE,EAAC,SAAS;UAAChE,KAAK,EAAElB,OAAQ;UAACmF,QAAQ,EAAEpE,CAAC,IAAId,UAAU,CAACc,CAAC,CAACC,MAAM,CAACE,KAAK,CAAE;UAACmE,QAAQ,EAAEnF;QAAU;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnG,CAAC,eACNnG,OAAA,CAACL,MAAM;QAACgH,IAAI,EAAC,QAAQ;QAACb,SAAS,EAAC,QAAQ;QAACY,QAAQ,EAAEnF,SAAU;QAAAwE,QAAA,EAC1DxE,SAAS,GAAG,cAAc,GAAG;MAAiB;QAAAyE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzC,CAAC,eACTnG,OAAA,CAACL,MAAM;QACLgH,IAAI,EAAC,QAAQ;QACb1B,OAAO,EAAC,SAAS;QACjBa,SAAS,EAAC,QAAQ;QAClBM,OAAO,EAAEA,CAAA,KAAM1E,QAAQ,CAAC,YAAY,CAAE;QACtCgF,QAAQ,EAAEnF,SAAU;QAAAwE,QAAA,EACrB;MAED;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL;EACP;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;AAACjG,EAAA,CA3SuBD,uBAAuB;EAAA,QAkB3BH,QAAQ,EACTJ,WAAW;AAAA;AAAAuH,EAAA,GAnBNhH,uBAAuB;AAAA,IAAAgH,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}